{"ast":null,"code":"// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport { get, count } from '../../../lib/utils'; // Basic polygon support\n//\n// Handles simple and complex polygons\n// Simple polygons are arrays of vertices, implicitly \"closed\"\n// Complex polygons are arrays of simple polygons, with the first polygon\n// representing the outer hull and other polygons representing holes\n\n/**\n * Check if this is a non-nested polygon (i.e. the first element of the first element is a number)\n * @param {Array} polygon - either a complex or simple polygon\n * @return {Boolean} - true if the polygon is a simple polygon (i.e. not an array of polygons)\n */\n\nexport function isSimple(polygon) {\n  return count(polygon) >= 1 && count(get(polygon, 0)) >= 2 && Number.isFinite(get(get(polygon, 0), 0));\n}\n/**\n * Normalize to ensure that all polygons in a list are complex - simplifies processing\n * @param {Array} polygon - either a complex or a simple polygon\n * @param {Object} opts\n * @param {Object} opts.dimensions - if 3, the coords will be padded with 0's if needed\n * @return {Array} - returns a complex polygons\n */\n\nexport function normalize(polygon) {\n  var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n      _ref$dimensions = _ref.dimensions,\n      dimensions = _ref$dimensions === undefined ? 3 : _ref$dimensions;\n\n  return isSimple(polygon) ? [polygon] : polygon;\n}\n/**\n * Check if this is a non-nested polygon (i.e. the first element of the first element is a number)\n * @param {Array} polygon - either a complex or simple polygon\n * @return {Boolean} - true if the polygon is a simple polygon (i.e. not an array of polygons)\n */\n\nexport function getVertexCount(polygon) {\n  return isSimple(polygon) ? count(polygon) : polygon.reduce(function (length, simplePolygon) {\n    return length + count(simplePolygon);\n  }, 0);\n} // Return number of triangles needed to tesselate the polygon\n\nexport function getTriangleCount(polygon) {\n  var triangleCount = 0;\n  var first = true;\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = normalize(polygon)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var simplePolygon = _step.value;\n      var size = count(simplePolygon);\n\n      if (first) {\n        triangleCount += size >= 3 ? size - 2 : 0;\n      } else {\n        triangleCount += size + 1;\n      }\n\n      first = false;\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return triangleCount;\n}\nexport function forEachVertex(polygon, visitor) {\n  if (isSimple(polygon)) {\n    polygon.forEach(visitor);\n    return;\n  }\n\n  var vertexIndex = 0;\n  polygon.forEach(function (simplePolygon) {\n    simplePolygon.forEach(function (v, i, p) {\n      return visitor(v, vertexIndex, polygon);\n    });\n    vertexIndex++;\n  });\n}","map":null,"metadata":{},"sourceType":"module"}