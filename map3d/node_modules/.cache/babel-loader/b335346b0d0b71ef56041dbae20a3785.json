{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport { uid } from '../utils';\nimport { Vector3, Matrix4 } from 'math.gl';\nimport assert from '../utils/assert';\n\nvar Object3D =\n/*#__PURE__*/\nfunction () {\n  function Object3D(_ref) {\n    var id = _ref.id,\n        _ref$display = _ref.display,\n        display = _ref$display === void 0 ? true : _ref$display;\n\n    _classCallCheck(this, Object3D); // whether to display the object at all\n\n\n    this.id = id || uid(this.constructor.name);\n    this.display = true; // model position, rotation, scale and all in all matrix\n\n    this.position = new Vector3();\n    this.rotation = new Vector3();\n    this.scale = new Vector3(1, 1, 1);\n    this.matrix = new Matrix4();\n    this.userData = {};\n  }\n\n  _createClass(Object3D, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"{id: \".concat(this.id, \", children: \").concat(this.children, \")}\");\n    }\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(position) {\n      assert(position.length === 3, 'setPosition requires vector argument');\n      this.position = position;\n      return this;\n    }\n  }, {\n    key: \"setRotation\",\n    value: function setRotation(rotation) {\n      assert(rotation.length === 3, 'setRotation requires vector argument');\n      this.rotation = rotation;\n      return this;\n    }\n  }, {\n    key: \"setScale\",\n    value: function setScale(scale) {\n      assert(scale.length === 3, 'setScale requires vector argument');\n      this.scale = scale;\n      return this;\n    }\n  }, {\n    key: \"setMatrixComponents\",\n    value: function setMatrixComponents(_ref2) {\n      var position = _ref2.position,\n          rotation = _ref2.rotation,\n          scale = _ref2.scale,\n          _ref2$update = _ref2.update,\n          update = _ref2$update === void 0 ? true : _ref2$update;\n\n      if (position) {\n        this.setPosition(position);\n      }\n\n      if (rotation) {\n        this.setRotation(rotation);\n      }\n\n      if (scale) {\n        this.setScale(scale);\n      }\n\n      if (update) {\n        this.updateMatrix();\n      }\n\n      return this;\n    }\n  }, {\n    key: \"updateMatrix\",\n    value: function updateMatrix() {\n      var pos = this.position;\n      var rot = this.rotation;\n      var scale = this.scale;\n      this.matrix.identity();\n      this.matrix.translate(pos);\n      this.matrix.rotateXYZ(rot);\n      this.matrix.scale(scale);\n      return this;\n    }\n  }, {\n    key: \"update\",\n    value: function update() {\n      var _ref3 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          position = _ref3.position,\n          rotation = _ref3.rotation,\n          scale = _ref3.scale;\n\n      if (position) {\n        this.setPosition(position);\n      }\n\n      if (rotation) {\n        this.setRotation(rotation);\n      }\n\n      if (scale) {\n        this.setScale(scale);\n      }\n\n      this.updateMatrix();\n      return this;\n    }\n  }, {\n    key: \"getCoordinateUniforms\",\n    value: function getCoordinateUniforms(viewMatrix, modelMatrix) {\n      // TODO - solve multiple class problem\n      // assert(viewMatrix instanceof Matrix4);\n      assert(viewMatrix);\n      modelMatrix = modelMatrix || this.matrix;\n      var worldMatrix = new Matrix4(viewMatrix).multiplyRight(modelMatrix);\n      var worldInverse = worldMatrix.invert();\n      var worldInverseTranspose = worldInverse.transpose();\n      return {\n        viewMatrix: viewMatrix,\n        modelMatrix: modelMatrix,\n        objectMatrix: modelMatrix,\n        worldMatrix: worldMatrix,\n        worldInverseMatrix: worldInverse,\n        worldInverseTransposeMatrix: worldInverseTranspose\n      };\n    } // TODO - copied code, not yet vetted\n\n  }, {\n    key: \"transform\",\n    value: function transform() {\n      if (!this.parent) {\n        this.endPosition.set(this.position);\n        this.endRotation.set(this.rotation);\n        this.endScale.set(this.scale);\n      } else {\n        var parent = this.parent;\n        this.endPosition.set(this.position.add(parent.endPosition));\n        this.endRotation.set(this.rotation.add(parent.endRotation));\n        this.endScale.set(this.scale.add(parent.endScale));\n      }\n\n      var ch = this.children;\n\n      for (var i = 0; i < ch.length; ++i) {\n        ch[i].transform();\n      }\n\n      return this;\n    }\n  }]);\n\n  return Object3D;\n}();\n\nexport { Object3D as default };","map":null,"metadata":{},"sourceType":"module"}